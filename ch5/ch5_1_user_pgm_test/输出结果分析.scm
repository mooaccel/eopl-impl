---

"if then分支"
exp2 = #(struct:call-exp #(struct:var-exp cont) (#(struct:const-exp 1))) 
exp3 = #(struct:call-exp #(struct:var-exp factk) (#(struct:diff-exp #(struct:var-exp n) #(struct:const-exp 1)) #(struct:proc-exp (val) #(struct:call-exp #(struct:var-exp cont) (#(struct:multiplication-exp #(struct:var-exp n) #(struct:var-exp val)))))))
saved_env = #(struct:extend-env (n cont) 
                                (#(struct:num-val 0) 
                                 #(struct:proc-val #(struct:procedure (val) 
                                                                      #(struct:call-exp #(struct:var-exp cont) (#(struct:multiplication-exp #(struct:var-exp n) #(struct:var-exp val)))) 
                                                                      #(struct:extend-env (n cont) 
                                                                                          (#(struct:num-val 1) #(struct:proc-val #(struct:procedure (val) 
                                                                                                                                                    #(struct:call-exp #(struct:var-exp cont) (#(struct:multiplication-exp #(struct:var-exp n) #(struct:var-exp val)))) 
                                                                                                                                                    #(struct:extend-env (n cont) 
                                                                                                                                                                        (#(struct:num-val 2) #(struct:proc-val #(struct:procedure (val) 
                                                                                                                                                                                                                                  #(struct:call-exp #(struct:var-exp cont) (#(struct:multiplication-exp #(struct:var-exp n) #(struct:var-exp val)))) 
                                                                                                                                                                                                                                  #(struct:extend-env (n cont) 
                                                                                                                                                                                                                                                      (#(struct:num-val 3) #(struct:proc-val #(struct:procedure (val) 
                                                                                                                                                                                                                                                                                                                #(struct:call-exp #(struct:var-exp cont) (#(struct:multiplication-exp #(struct:var-exp n) #(struct:var-exp val)))) 
                                                                                                                                                                                                                                                                                                                #(struct:extend-env (n cont) 
                                                                                                                                                                                                                                                                                                                                    (#(struct:num-val 4) #(struct:proc-val #(struct:procedure (val) 
                                                                                                                                                                                                                                                                                                                                                                                              #(struct:call-exp #(struct:var-exp cont) (#(struct:multiplication-exp #(struct:var-exp n) #(struct:var-exp val)))) 
                                                                                                                                                                                                                                                                                                                                                                                              #(struct:extend-env (n cont) 
                                                                                                                                                                                                                                                                                                                                                                                                                  (#(struct:num-val 5) #(struct:proc-val #(struct:procedure (val) 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            #(struct:var-exp val) 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            #(struct:extend-env-rec factk 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    (n cont) 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #(struct:if-exp #(struct:zero?-exp #(struct:var-exp n)) #(struct:call-exp #(struct:var-exp cont) (#(struct:const-exp 1))) #(struct:call-exp #(struct:var-exp factk) (#(struct:diff-exp #(struct:var-exp n) #(struct:const-exp 1)) #(struct:proc-exp (val) #(struct:call-exp #(struct:var-exp cont) (#(struct:multiplication-exp #(struct:var-exp n) #(struct:var-exp val)))))))) 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    #(struct:extend-env (i) 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (#(struct:num-val 1)) 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        #(struct:extend-env (v) 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (#(struct:num-val 5)) 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            #(struct:extend-env (x) 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                (#(struct:num-val 10)) 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                #(struct:empty-env)))))))) 
                                                                                                                                                                                                                                                                                                                                                                                                                  #(struct:extend-env-rec factk 
                                                                                                                                                                                                                                                                                                                                                                                                                                          (n cont) 
                                                                                                                                                                                                                                                                                                                                                                                                                                          #(struct:if-exp #(struct:zero?-exp #(struct:var-exp n)) #(struct:call-exp #(struct:var-exp cont) (#(struct:const-exp 1))) #(struct:call-exp #(struct:var-exp factk) (#(struct:diff-exp #(struct:var-exp n) #(struct:const-exp 1)) #(struct:proc-exp (val) #(struct:call-exp #(struct:var-exp cont) (#(struct:multiplication-exp #(struct:var-exp n) #(struct:var-exp val)))))))) 
                                                                                                                                                                                                                                                                                                                                                                                                                                          #(struct:extend-env (i) 
                                                                                                                                                                                                                                                                                                                                                                                                                                                              (#(struct:num-val 1)) 
                                                                                                                                                                                                                                                                                                                                                                                                                                                              #(struct:extend-env (v) 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (#(struct:num-val 5)) 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  #(struct:extend-env (x) 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      (#(struct:num-val 10)) 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      #(struct:empty-env))))))))) 
                                                                                                                                                                                                                                                                                                                                    #(struct:extend-env-rec factk 
                                                                                                                                                                                                                                                                                                                                                            (n cont) 
                                                                                                                                                                                                                                                                                                                                                            #(struct:if-exp #(struct:zero?-exp #(struct:var-exp n)) #(struct:call-exp #(struct:var-exp cont) (#(struct:const-exp 1))) #(struct:call-exp #(struct:var-exp factk) (#(struct:diff-exp #(struct:var-exp n) #(struct:const-exp 1)) #(struct:proc-exp (val) #(struct:call-exp #(struct:var-exp cont) (#(struct:multiplication-exp #(struct:var-exp n) #(struct:var-exp val)))))))) 
                                                                                                                                                                                                                                                                                                                                                            #(struct:extend-env (i) 
                                                                                                                                                                                                                                                                                                                                                                                (#(struct:num-val 1)) 
                                                                                                                                                                                                                                                                                                                                                                                #(struct:extend-env (v) 
                                                                                                                                                                                                                                                                                                                                                                                                    (#(struct:num-val 5)) 
                                                                                                                                                                                                                                                                                                                                                                                                    #(struct:extend-env (x) 
                                                                                                                                                                                                                                                                                                                                                                                                                        (#(struct:num-val 10)) 
                                                                                                                                                                                                                                                                                                                                                                                                                        #(struct:empty-env))))))))) 
                                                                                                                                                                                                                                                      #(struct:extend-env-rec factk 
                                                                                                                                                                                                                                                                              (n cont) 
                                                                                                                                                                                                                                                                              #(struct:if-exp #(struct:zero?-exp #(struct:var-exp n)) #(struct:call-exp #(struct:var-exp cont) (#(struct:const-exp 1))) #(struct:call-exp #(struct:var-exp factk) (#(struct:diff-exp #(struct:var-exp n) #(struct:const-exp 1)) #(struct:proc-exp (val) #(struct:call-exp #(struct:var-exp cont) (#(struct:multiplication-exp #(struct:var-exp n) #(struct:var-exp val)))))))) 
                                                                                                                                                                                                                                                                              #(struct:extend-env (i) 
                                                                                                                                                                                                                                                                                                  (#(struct:num-val 1)) 
                                                                                                                                                                                                                                                                                                  #(struct:extend-env (v) 
                                                                                                                                                                                                                                                                                                                      (#(struct:num-val 5)) 
                                                                                                                                                                                                                                                                                                                      #(struct:extend-env (x) 
                                                                                                                                                                                                                                                                                                                                          (#(struct:num-val 10)) 
                                                                                                                                                                                                                                                                                                                                          #(struct:empty-env))))))))) 
                                                                                                                                                                        #(struct:extend-env-rec factk 
                                                                                                                                                                                                (n cont) 
                                                                                                                                                                                                #(struct:if-exp #(struct:zero?-exp #(struct:var-exp n)) #(struct:call-exp #(struct:var-exp cont) (#(struct:const-exp 1))) #(struct:call-exp #(struct:var-exp factk) (#(struct:diff-exp #(struct:var-exp n) #(struct:const-exp 1)) #(struct:proc-exp (val) #(struct:call-exp #(struct:var-exp cont) (#(struct:multiplication-exp #(struct:var-exp n) #(struct:var-exp val)))))))) 
                                                                                                                                                                                                #(struct:extend-env (i) 
                                                                                                                                                                                                                    (#(struct:num-val 1)) 
                                                                                                                                                                                                                    #(struct:extend-env (v) 
                                                                                                                                                                                                                                        (#(struct:num-val 5)) 
                                                                                                                                                                                                                                        #(struct:extend-env (x) 
                                                                                                                                                                                                                                                            (#(struct:num-val 10)) 
                                                                                                                                                                                                                                                            #(struct:empty-env))))))))) 
                                                                                          #(struct:extend-env-rec factk 
                                                                                                                  (n cont) 
                                                                                                                  #(struct:if-exp #(struct:zero?-exp #(struct:var-exp n)) #(struct:call-exp #(struct:var-exp cont) (#(struct:const-exp 1))) #(struct:call-exp #(struct:var-exp factk) (#(struct:diff-exp #(struct:var-exp n) #(struct:const-exp 1)) #(struct:proc-exp (val) #(struct:call-exp #(struct:var-exp cont) (#(struct:multiplication-exp #(struct:var-exp n) #(struct:var-exp val)))))))) 
                                                                                                                  #(struct:extend-env (i) 
                                                                                                                                      (#(struct:num-val 1)) 
                                                                                                                                      #(struct:extend-env (v) 
                                                                                                                                                          (#(struct:num-val 5)) 
                                                                                                                                                          #(struct:extend-env (x) 
                                                                                                                                                                              (#(struct:num-val 10)) 
                                                                                                                                                                              #(struct:empty-env))))))))) 
                                #(struct:extend-env-rec factk 
                                                        (n cont) 
                                                        #(struct:if-exp #(struct:zero?-exp #(struct:var-exp n)) #(struct:call-exp #(struct:var-exp cont) (#(struct:const-exp 1))) #(struct:call-exp #(struct:var-exp factk) (#(struct:diff-exp #(struct:var-exp n) #(struct:const-exp 1)) #(struct:proc-exp (val) #(struct:call-exp #(struct:var-exp cont) (#(struct:multiplication-exp #(struct:var-exp n) #(struct:var-exp val)))))))) 
                                                        #(struct:extend-env (i) 
                                                                            (#(struct:num-val 1)) 
                                                                            #(struct:extend-env (v) 
                                                                                                (#(struct:num-val 5)) 
                                                                                                #(struct:extend-env (x) 
                                                                                                                    (#(struct:num-val 10)) 
                                                                                                                    #(struct:empty-env)))))) 


saved_cont = #(struct:end-cont)

; 用户程序写成cps的, 那么底下的解释的cont就不需要维持额外的control context了!!!
; 信息全在env里了...